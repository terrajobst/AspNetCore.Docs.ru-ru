---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Тестирование с помощью Crank плотности подключений SignalR | Документация Майкрософт
author: tfitzmac
description: Тестирование с помощью Crank плотности подключений SignalR
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/22/2015
ms.topic: article
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
ms.technology: dotnet-signalr
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: c4ca8e368c8b722cc81ae7367140fd22f6fc7fd1
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2018
ms.locfileid: "37367830"
---
<a name="signalr-connection-density-testing-with-crank"></a>Тестирование с помощью Crank плотности подключений SignalR
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье описывается, как использовать средство ручки для тестирования приложения с несколькими клиентами имитации.


После запуска приложения в его среде размещения (либо Azure веб-роли, службы IIS, или размещение с помощью Owin) можно проверить ответ приложения на высокий уровень плотности подключений, используя средство ручки. Среда размещения может быть сервер Internet Information Services (IIS), хостом Owin или веб-роли Azure. (Примечание: счетчики производительности не доступны на веб-приложениях службы приложений Azure, поэтому вы не сможете получить данные о производительности от плотности Проверка подключения.)

Плотность подключения ссылается на число одновременных TCP-подключений, которые можно установить на сервере. Влечет за собой свой собственный издержки для каждого TCP-подключения и открыв большое количество неактивных соединений в конечном счете создаст узкое место в памяти.

[SignalR codebase](https://github.com/signalr/signalr) включает нагрузочного тестирования утилиту **Crank**. Можно найти в последней версии Crank [ветви Dev](https://github.com/SignalR/signalr/tree/dev) на сайте GitHub. Вы можете скачать ZIP-файла архива ветви Dev SignalR codebase [здесь](https://github.com/SignalR/SignalR/archive/dev.zip).

Crank может использоваться для полностью насыщения памяти сервера, чтобы вычислить общее количество неактивных соединений, возможно на серверное оборудование. Кроме того вы может также использовать ручки для нагрузочного теста сервера под определенный объем нехватки памяти, увеличивать подключений, пока не будет достигнуто значение конкретного счетчика или пороговое значение памяти.

При тестировании, очень важно использовать удаленных клиентах, чтобы избежать любой конкуренция за ресурсы (т. е. TCP-подключения и память). Мониторинг клиентов, чтобы убедиться, что они не превышают узкие места, которые могут помешать серверу достижения в полном объеме (памяти или ЦП). Может потребоваться увеличить число клиентов для полной загрузки сервера.

### <a name="running-a-connection-density-test"></a>Выполнение теста плотность подключения

В этом разделе описываются шаги, которые необходимы для запуска теста плотность подключения в приложении SignalR.

1. Загрузить и построить [codebase ветвь разработки SignalR](https://github.com/SignalR/SignalR/archive/dev.zip). В командной строке перейдите в раздел &lt;каталог проекта&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.
2. Развернете приложение для его предполагаемой средой размещения. Запомните или запишите конечной точки, используемые приложением; Например, в приложение, созданное в [учебнике Приступая к работе](../getting-started/tutorial-getting-started-with-signalr.md), конечная точка имеет `http://<yourhost>:8080/signalr`.
3. Установка [счетчиков производительности SignalR](signalr-performance.md#perfcounters) на сервере. Если приложение работает под управлением Azure, см. в разделе [с помощью счетчиков производительности SignalR в веб-роли Azure](using-signalr-performance-counters-in-an-azure-web-role.md).

Как только вы загрузили и построение базы кода и установлены счетчики производительности на узле, средство командной строки Crank можно найти в `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` папку.

Доступные параметры для средства Crank:

- **/?** : Показан экран справки. Доступные параметры отображаются также в том случае, если **URL-адрес** параметр пропущен.
- **/ URL-адрес**: URL-адрес для подключений SignalR. Этот параметр обязателен. Для приложения SignalR, использование сопоставления по умолчанию, путь будет завершен через «/ signalr».
- **/ Транспорта**: имя используемый транспорт. По умолчанию используется `auto`, который выберет наиболее протокола. Параметры включают `WebSockets`, `ServerSentEvents`, и `LongPolling` (`ForeverFrame` не подходит для ручки, так как клиент .NET, а не должен использоваться Internet Explorer). Дополнительные сведения о том, как SignalR выбирает транспортов, см. в разделе [транспорта и в случае ошибки](../getting-started/introduction-to-signalr.md#transports).
- **/ BatchSize**: количество клиентов, которые добавлены в каждом пакете. Значение по умолчанию — 50.
- **/ ConnectInterval**: интервал в миллисекундах между добавлением подключения. Значение по умолчанию — 500.
- **/ Подключений**: количество соединений, используемых для тестирования нагрузки приложения. Значение по умолчанию равно 100 000.
- **/ ConnectTimeout**: время ожидания в секундах до прерывания тестового. Значение по умолчанию — 300.
- **MinServerMBytes**: МБ для достижения минимальной серверной. Значение по умолчанию — 500.
- **SendBytes**: размер полезных данных, отправляемых на сервер, в байтах. Значение по умолчанию — 0.
- **SendInterval**: задержку в миллисекундах между сообщениями на сервер. Значение по умолчанию — 500.
- **SendTimeout**: время ожидания в миллисекундах для сообщений на сервер. Значение по умолчанию — 300.
- **ControllerUrl**: URL-адрес, где один клиент будет размещаться концентратор контроллера. Значение по умолчанию имеет значение null (нет контроллеров). Контроллер концентратор запускается при запуске сеанса ручки; выполняется дальнейшая контакта между контроллеров и ручки.
- **NumClients**: число имитации клиентов для подключения к приложению. Значение по умолчанию — один.
- **Файл журнала**: имя файла для файла журнала для тестового запуска. Значение по умолчанию — `crank.csv`.
- **SampleInterval**: время в миллисекундах между значения выборки счетчиков производительности. Значение по умолчанию — 1000.
- **SignalRInstance**: имя экземпляра для счетчиков производительности на сервере. Значение по умолчанию — использовать состояние подключения клиента.

### <a name="example"></a>Пример

Следующая команда проверит узла с именем `pfsignalr` в Azure, на котором размещается приложение через порт 8080 в центре, с именем «ControllerHub», с использованием 100 соединений.

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`
