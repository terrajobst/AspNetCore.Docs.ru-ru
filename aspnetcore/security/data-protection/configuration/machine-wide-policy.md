---
title: Поддержка политики защиты данных на уровне компьютера в ASP.NET Core
author: rick-anderson
description: Узнайте о поддержке настройки политики на уровне компьютера по умолчанию для всех приложений, использующих ASP.NET Core защиту данных.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/configuration/machine-wide-policy
ms.openlocfilehash: 70aaca7afcd3df22cebb4466fbd9845a2277688c
ms.sourcegitcommit: 9a129f5f3e31cc449742b164d5004894bfca90aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78655066"
---
# <a name="data-protection-machine-wide-policy-support-in-aspnet-core"></a>Поддержка политики защиты данных на уровне компьютера в ASP.NET Core

Автор: [Рик Андерсон](https://twitter.com/RickAndMSFT)

При работе в Windows система защиты данных имеет ограниченную поддержку настройки политики на уровне компьютера по умолчанию для всех приложений, использующих ASP.NET Core защиту данных. Общая идея состоит в том, что администратору может потребоваться изменить значение по умолчанию, например используемые алгоритмы или время существования ключа, без необходимости вручную обновлять каждое приложение на компьютере.

> [!WARNING]
> Системный администратор может задать политику по умолчанию, но не может применить ее. Разработчик приложения всегда может переопределить любое значение одним из его собственных выборок. Политика по умолчанию влияет только на приложения, для которых разработчик не указал явно значение параметра.

## <a name="setting-default-policy"></a>Настройка политики по умолчанию

Чтобы задать политику по умолчанию, администратор может задать известные значения в системном реестре в следующем разделе реестра:

**хклм\софтваре\микрософт\дотнетпаккажес\микрософт.аспнеткоре.датапротектион**

Если вы используете 64-разрядную операционную систему и хотите повлиять на поведение 32-разрядных приложений, не забудьте настроить Wow6432Node, эквивалентный приведенному выше ключу.

Ниже приведены поддерживаемые значения.

| Значение              | Тип   | Description |
| ------------------ | :----: | ----------- |
| EncryptionType     | строка | Указывает, какие алгоритмы следует использовать для защиты данных. Значение должно быть CNG-CBC, CNG-GCM или управляемым и более подробно описано ниже. |
| дефаулткэйлифетиме | DWORD  | Указывает время существования только что созданных ключей. Значение указывается в днях и должно быть > = 7. |
| кэйескровсинкс     | строка | Указывает типы, используемые для депонирования ключей. Значение представляет собой разделенный точками с запятой список допустимых приемников ключей, где каждый элемент в списке является именем типа, реализующего [икэйескровсинк](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink). |

## <a name="encryption-types"></a>Типы шифрования

Если EncryptionType имеет CNG-CBC, система настроена на использование симметричного блочного шифра в режиме CBC для обеспечения конфиденциальности и HMAC для подлинности с помощью служб, предоставляемых Windows CNG (Дополнительные сведения см. в разделе [Указание пользовательских алгоритмов CNG Windows](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) ). Поддерживаются следующие дополнительные значения, каждое из которых соответствует свойству типа Кнгкбкаусентикатеденкриптионсеттингс.

| Значение                       | Тип   | Description |
| --------------------------- | :----: | ----------- |
| EncryptionAlgorithm         | строка | Имя алгоритма симметричного блочного шифрования, понятного CNG. Этот алгоритм открыт в режиме CBC. |
| енкриптионалгорисмпровидер | строка | Имя реализации поставщика CNG, которая может создать алгоритм EncryptionAlgorithm. |
| енкриптионалгорисмкэйсизе  | DWORD  | Длина (в битах) ключа, который должен быть производным от алгоритма симметричного блочного шифра. |
| HashAlgorithm               | строка | Имя хэш-алгоритма, понятного CNG. Этот алгоритм открыт в режиме HMAC. |
| хашалгорисмпровидер       | строка | Имя реализации поставщика CNG, которая может создать алгоритм HashAlgorithm. |

Если EncryptionType имеет CNG-GCM, система настроена на использование симметричного блочного шифра в режиме Галоис/Counter для обеспечения конфиденциальности и подлинности с помощью служб, предоставляемых Windows CNG (Дополнительные сведения см. в разделе [Указание пользовательских алгоритмов CNG Windows](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) ). Поддерживаются следующие дополнительные значения, каждое из которых соответствует свойству типа Кнггкмаусентикатеденкриптионсеттингс.

| Значение                       | Тип   | Description |
| --------------------------- | :----: | ----------- |
| EncryptionAlgorithm         | строка | Имя алгоритма симметричного блочного шифрования, понятного CNG. Этот алгоритм открыт в режиме Галоис/Counter. |
| енкриптионалгорисмпровидер | строка | Имя реализации поставщика CNG, которая может создать алгоритм EncryptionAlgorithm. |
| енкриптионалгорисмкэйсизе  | DWORD  | Длина (в битах) ключа, который должен быть производным от алгоритма симметричного блочного шифра. |

Если EncryptionType является управляемым, система настраивается на использование управляемого SymmetricAlgorithm для обеспечения конфиденциальности и KeyedHashAlgorithm для подлинности (Дополнительные сведения см. в разделе [Указание пользовательских управляемых алгоритмов](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) ). Поддерживаются следующие дополнительные значения, каждое из которых соответствует свойству типа Манажедаусентикатеденкриптионсеттингс.

| Значение                      | Тип   | Description |
| -------------------------- | :----: | ----------- |
| енкриптионалгорисмтипе    | строка | Имя с указанием сборки типа, реализующего SymmetricAlgorithm. |
| енкриптионалгорисмкэйсизе | DWORD  | Длина (в битах) ключа, производного от алгоритма симметричного шифрования. |
| валидатионалгорисмтипе    | строка | Имя с указанием сборки типа, реализующего KeyedHashAlgorithm. |

Если EncryptionType имеет любое другое значение, отличное от NULL или пустое, система защиты данных выдает исключение при запуске.

> [!WARNING]
> При настройке параметра политики по умолчанию, включающего имена типов (Енкриптионалгорисмтипе, Валидатионалгорисмтипе, Кэйескровсинкс), эти типы должны быть доступны приложению. Это означает, что для приложений, работающих на настольных средах CLR, сборки, содержащие эти типы, должны присутствовать в глобальном кэше сборок (GAC). Для ASP.NET Core приложений, работающих в .NET Core, должны быть установлены пакеты, содержащие эти типы.
