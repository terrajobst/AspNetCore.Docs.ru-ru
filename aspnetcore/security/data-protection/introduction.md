---
title: Защита данных в ASP.NET Core
author: rick-anderson
description: Дополнительные сведения о концепции защиты данных и принципы проектирования API защиты данных ASP.NET Core.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/introduction
ms.openlocfilehash: 29a2bbef6f2fd9b61541173af143926ca82bfad7
ms.sourcegitcommit: 3ca527f27c88cfc9d04688db5499e372fbc2c775
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/17/2018
ms.locfileid: "39095699"
---
# <a name="aspnet-core-data-protection"></a>Защита данных в ASP.NET Core

Веб-приложений часто требуется хранить конфиденциальные данные. Windows предоставляет DPAPI для настольных приложений, но это не подходит для веб-приложений. В стеке защиты данных ASP.NET Core предоставляют простой и удобный API криптографии, разработчик может использовать для защиты данных, включая управление ключами и поворота.

В стеке защиты данных ASP.NET Core предназначена для использования в качестве долговременной замены для &lt;machineKey&gt; элемент в ASP.NET 1.x - 4.x. Она была разработана для решения многих недостатков старый стек шифрования в то же время предоставляя решение out of box для большинства вариантов использования современных приложений, которые могут возникнуть.

## <a name="problem-statement"></a>Постановка

Оператор общей проблемы можно кратко сформулировать в предложение: мне нужно сохранить достоверную информацию для последующего извлечения, но я не доверяю механизм сохранения. В терминах web это могут быть написаны как «Мне нужно приема-передачи доверенного состоянием через ненадежный клиент».

Каноническим примером этого является файл cookie проверки подлинности или носителя токена. Сервер создает «Я Groot и иметь разрешения xyz» маркеров и передает его клиенту. ןנמרוסעגטט םוךמעמנמדמ клиент представляет токен на сервер, но этот сервер должен каким-либо гарантии, что клиент не поддельных маркер. Поэтому первым требованием: подлинность (так называемые) целостность, проверки изменений).

Так как сохраненное состояние является доверенным для сервера, мы ожидаем, что это состояние может содержать сведения, относящиеся к операционной среде. Это может быть в виде пути к файлу, разрешение, дескриптор или других косвенную ссылку или иную часть данных конкретного сервера. Такая информация, обычно не закрыты в для ненадежный клиент. Таким образом второе требование: конфиденциальность.

И, наконец так как из отдельных компонентов современных приложений, мы узнали является отдельные компоненты будут пользоваться преимуществами этой системы независимо от других компонентов в системе. Например если компонент токена носителя использует этот стек, его следует эксплуатировать без вмешательства механизм anti-CSRF, который также могут использовать тот же стек. Таким образом окончательный требование: изоляции.

Мы может предоставить, дополнительные ограничения Чтобы сузить область действия наших требований. Мы предполагаем, что все службы, находящейся в пределах криптосистеме, одинаково доверяют и что данные не обязательно должны использовать за пределами служб контролируем прямой или создан. Кроме того мы требуем, что операции являются максимально возможной скоростью, так как каждый запрос к веб-службе может пройти через криптосистеме один или несколько раз. В результате симметричного шифрования идеально подходят для нашего сценария, и мы скидки асимметричной криптографии, пока такое время, которое она нужна.

## <a name="design-philosophy"></a>Принципы разработки

Мы начали с определения проблем в существующий комплект. После создания, мы опрошенных сферу существующих решений и предполагает, что нет существующего решения необходимо было довольно проверялось их возможности. Затем разработке решений на базе нескольких руководящие принципы.

* Система следует предлагать простота настройки. В идеале система будет настройки и разработчикам удалось карьер. В ситуациях, где разработчики должны настроить определенный аспект (например, хранилище ключей) следует учитывать для принятия этих конкретных конфигурациях простой.

* Предлагают простой потребительских API. API-интерфейсы должны быть легко использовать правильно и сложно использовать неправильно.

* Разработчики не должны изучите принципы управления ключами. Система должна обработать выбора алгоритма и ключа времени существования от имени разработчика. В идеале разработчик вообще никогда не должен иметь доступ к необработанные материал ключа.

* Ключи должны быть защищены при хранении, когда это возможно. Система должна понять механизм защиты соответствующее значение по умолчанию и применить его автоматически.

С помощью этих принципов в виду, мы разработали это простые, [прост в использовании](xref:security/data-protection/using-data-protection) стеке защиты данных.

Интерфейсы API защиты данных ASP.NET Core не предназначены главным образом для неопределенного сохраняемости конфиденциальных полезных данных. Другие технологии, такие как [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) и [Azure Rights Management](https://docs.microsoft.com/rights-management/) больше подходят для сценария неопределенное хранилища, и они обладают возможностями соответственно строгого управления ключами. С другой стороны, нет ничего запрет разработчику использовать интерфейсы API защиты данных ASP.NET Core для долгосрочной защиты конфиденциальных данных.

## <a name="audience"></a>Аудитория

Система защиты данных состоит из пяти основных пакетов. Различные аспекты эти API-интерфейсы целевую три основных аудиторию;

1. [Обзор потребительских API](xref:security/data-protection/consumer-apis/overview) предназначенных для разработчиков приложений и платформы.

   «Я не хочу узнать о работой стека или о его конфигурации. Я просто хочу выполнить некую операцию, в как простой, так как можно с высокой вероятностью успешно с помощью API-интерфейсы.»

2. [Интерфейсов API настройки](xref:security/data-protection/configuration/overview) предназначенных для разработчиков приложений и системных администраторов.

   «Мне нужно сообщить система защиты данных, что нам требуется пути не по умолчанию и параметры».

3. Разработчики целевой API-интерфейсы расширяемости ответственный за реализация пользовательской политики. Использование этих API-интерфейсов ограничен редких случаях и опыт работы, учитывать разработчикам безопасности.

   «Мне нужно заменить весь компонент в системе, так как у меня действительно уникальной требования относительно поведения. Я хочу узнать uncommonly используемых частей поверхность API для создания подключаемого модуля, который соответствует моим требованиям.»

## <a name="package-layout"></a>Макет пакета

В стеке защиты данных состоит из пяти пакетов.

* Microsoft.AspNetCore.DataProtection.Abstractions содержит основные интерфейсы IDataProtectionProvider и IDataProtector. Он также содержит методы полезные расширения, которые могут помочь в работе с этими типами (например, из-за перегрузки IDataProtector.Protect). В разделе потребителя интерфейсов Дополнительные сведения. Если вы просто используют API-интерфейсы, кто отвечает за создание экземпляра система защиты данных, стоит ссылка Microsoft.AspNetCore.DataProtection.Abstractions.

* Microsoft.AspNetCore.DataProtection содержит реализацию ядра системы защиты данных, в том числе core криптографических операций, управления ключами, настройки и расширяемости. Если вы отвечаете за создание экземпляра система защиты данных (например, добавив его IServiceCollection) или изменения или расширения его поведение, стоит ссылка Microsoft.AspNetCore.DataProtection.

* Microsoft.AspNetCore.DataProtection.Extensions содержит дополнительные API-интерфейсы, которые разработчики могут оказаться полезными, но который не входящие в базовый пакет. Например этот пакет содержит простой API «создать экземпляр системы, указывающий на каталог конкретного ключа хранилища без настройки внедрения зависимостей» (Дополнительные сведения). Он также содержит методы расширения для ограничение времени существования защищенных полезных данных (Дополнительная информация).

* Microsoft.AspNetCore.DataProtection.SystemWeb может устанавливаться в существующее приложение ASP.NET 4.x, чтобы перенаправить его &lt;machineKey&gt; операций, чтобы вместо этого использовать новый стек защиты данных. См. в разделе [совместимости](xref:security/data-protection/compatibility/replacing-machinekey#compatibility-replacing-machinekey) Дополнительные сведения.

* Microsoft.AspNetCore.Cryptography.KeyDerivation предоставляет реализацию хэширования подпрограмма пароль PBKDF2 и может использоваться в системах, которые должны надежно обрабатывать пароли пользователей. См. в разделе [хэширования паролей](xref:security/data-protection/consumer-apis/password-hashing) Дополнительные сведения.

## <a name="additional-resources"></a>Дополнительные ресурсы

<xref:host-and-deploy/web-farm>
