---
title: Вспомогательная функция тега изображения в ASP.NET Core
author: pkellner
description: Сведения о работе со вспомогательной функцией тега изображения.
ms.author: riande
ms.custom: mvc
ms.date: 04/06/2019
uid: mvc/views/tag-helpers/builtin-th/image-tag-helper
ms.openlocfilehash: 916a68c187cbf516a59d3c5d7578cdb6ada01b86
ms.sourcegitcommit: 5b0eca8c21550f95de3bb21096bd4fd4d9098026
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2019
ms.locfileid: "64887669"
---
# <a name="image-tag-helper-in-aspnet-core"></a>Вспомогательная функция тега изображения в ASP.NET Core

Автор: [Питер Кельнер (Peter Kellner)](http://peterkellner.net)

Вспомогательная функция тега изображения расширяет возможности тега `<img>`, чтобы предоставлять поведение отключения кэширования для файлов статических изображений.

Строка отключения кэширования — это уникальное значение, представляющее хэш-код статического файла изображения, добавленный к URL-адресу ресурса. Уникальная строка требует у клиентов (и некоторых прокси-серверов) повторно загружать изображение с веб-сервера, а не из кэша клиента.

Если источник изображения (`src`) представляет собой статический файл на веб-сервере:

* Уникальная строка отключения кэширования добавляется в качестве параметра запроса к источнику изображения.
* При изменении файла на веб-сервере узла создается уникальный URL-адрес запроса, включающий в себя обновленный параметр запроса.

Общие сведения о вспомогательных функциях тегов см. здесь: <xref:mvc/views/tag-helpers/intro>.

## <a name="image-tag-helper-attributes"></a>Атрибуты вспомогательной функции тега изображения

### <a name="src"></a>src

Для активации вспомогательной функции тега изображения требуется атрибут `src` в элементе `<img>`.

Источник изображения (`src`) должен указывать на физический статический файл на сервере. Если `src` — это удаленный URI, параметр строки запроса отключения кэширования не создается.

### <a name="asp-append-version"></a>asp-append-version

Если указан `asp-append-version` со значением `true` и атрибутом `src`, вызывается вспомогательная функция тега изображения.

В приведенном ниже примере используется вспомогательная функция тега изображения:

```cshtml
<img src="~/images/asplogo.png" asp-append-version="true">
```

Если статический файл существует в каталоге */wwwroot/images/*, создаваемый код HTML будет похож на следующий (хэш-код будет иным):

```html
<img src="/images/asplogo.png?v=Kl_dqr9NVtnMdsM2MUg4qthUnWZm5T1fCEimBPWDNgM">
```

В качестве значения параметру `v` присваивается значение хэша файла *asplogo.png* на диске. Если веб-серверу не удается получить доступ для чтения к указанному статическому файлу, параметр `v` не добавляется к атрибуту `src` в преобразованной разметке.

## <a name="hash-caching-behavior"></a>Поведение кэширования хэша

Вспомогательная функция тега изображения использует поставщик кэша на локальном веб-сервере для хранения значения хэша `Sha512`, вычисленного для данного файла. Если файл запрашивается несколько раз, хэш не пересчитывается. Наблюдатель, который назначается файлу при вычислении его значения хэша `Sha512`, делает кэш недействительным. При изменении файла на диске вычисляется и кэшируется новый хэш.

## <a name="additional-resources"></a>Дополнительные ресурсы

* <xref:performance/caching/memory>
